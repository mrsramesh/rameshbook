<!-- new file with new file -->
<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Output Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f2f2f2;
            position: relative;
        }

        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        h1 {
            text-align: center;
            color: #333;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            padding: 10px;
            border: 1px solid #ccc;
            text-align: left;
        }

        th {
            background-color: #f9f9f9;
            color: #555;
        }

        input[type="text"], input[type="date"] {
            width: 100%;
            padding: 8px;
            border: none;
            border-radius: 4px;
            box-sizing: border-box;
            background-color: #f9f9f9;
            color: #333;
            margin-bottom: 10px;
        }

        input[type="text"]:read-only {
            background-color: #ddd;
            color: #777;
            cursor: not-allowed;
        }

        .date-input {
            position: absolute;
            top: 10px;
            right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Output Page</h1>
        <div class="date-input">
            <label for="outputDate">Date:</label>
            <input type="date" id="outputDate">
        </div>
        <table>
            <thead>
                <tr>
                    <th>Old Mal</th>
                    <th>Entry</th>
                    <th>Total</th>
                    <th>Remain</th>
                    <th>Bikri</th>
                    <th> DAR </th>
                    <th>Kimat</th>
                   // !-- <th>Profit</th> --
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" id="output1" readonly></td>
                    <td><input type="text" id="output2" readonly></td>
                    <td><input type="text" id="output3" readonly></td>
                    <td><input type="text" id="output4" readonly></td>
                    <td><input type="text" id="output5" readonly></td>
                    <td>70</td>
                    <td><input type="text" id="output6" readonly></td>
                </tr>
            </tbody>
        </table>
        <h2>Extra Fields</h2>
        <table>
            <tr>
                <td>
                    <label for="output7">Profit :</label>
                   <input type="text" id="output7" readonly>
                  </td>

                <td colspan="2">
                    <label for="output8">Profit after Expense:</label>
                    <input type="text" id="output8" readonly>
                </td>
           
            </tr>
        </table>
    </div>

    <script>
        // Retrieve inputs from local storage and display them
        var a = parseFloat(localStorage.getItem('input1'));
        var b = parseFloat(localStorage.getItem('input2'));
        var e = parseFloat(localStorage.getItem('input5'));
        var h = parseFloat(localStorage.getItem('input7'));
        var i = parseFloat(localStorage.getItem('input8'));
        
        document.getElementById('output1').value = a ;
        document.getElementById('output2').value = b ;
        document.getElementById('output3').value = a + b;
        document.getElementById('output4').value = a+b-e;
        document.getElementById('output5').value =  e;
        document.getElementById('output6').value = e * 75;
        document.getElementById('output7').value = h-(e*75);
        document.getElementById('output8').value = (h-(e*75)-i);

        // Set the date input tag to the current date
        var today = new Date().toISOString().split('T')[0];
        document.getElementById('outputDate').value = today;
    </script>
</body>
</html> -->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Output Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f2f2f2;
            position: relative;
            background-image: linear-gradient(45deg, #FF6B6B, #556270);
        }

        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            position: relative;
            animation: fadeIn 1s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        h1 {
            text-align: center;
            color: #333;
            font-size: 28px;
            margin-bottom: 20px;
            color: #fff;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
        }

        th, td {
            padding: 10px;
            border: 1px solid #ccc;
            text-align: left;
            color: #333;
        }

        th {
            background-color: #f9f9f9;
            color: #555;
        }

        .profit-positive {
            color: green;
        }

        .profit-negative {
            color: red;
        }

        .highlight {
            background-color: yellow;
        }

        input[type="text"], input[type="date"] {
            width: calc(100% - 20px);
            padding: 8px;
            border: none;
            border-radius: 4px;
            box-sizing: border-box;
            background-color: #f9f9f9;
            color: #333;
            margin-bottom: 10px;
            outline: none;
            transition: background-color 0.3s ease;
        }

        input[type="text"]:read-only {
            background-color: #ddd;
            color: #777;
            cursor: not-allowed;
        }

        .date-input {
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .btn , #navigateButton ,#genatedata {
            display: block;
            width: 120px;
            margin: 0 auto;
            padding: 10px;
            background-color: #ff3c70;
            color: #fff;
            text-align: center;
            text-decoration: none;
            font-size: 16px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        .btn:hover {
            background-color: #ff3c90;
        }
        
        /* voie typing style */
          /* Your CSS styles here */
          .voice-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
        }
        

 
  
table tr th{
    width: 20px;
    border: 4px solid black;
    border-collapse: collapse;
}
table tr td{
    
    border: 2px solid black;
    border-collapse: collapse;
    align-items: center;

}
table{
    border-collapse: collapse;
}
input[type=text] ,input[type=number]{
    width: 100%;
    padding: 15px 5px;
    margin: 0px 0;
    box-sizing: border-box;
    text-align: center;
    color: blue ;
    font-size: 30px;
  }
h3{
    font-size: 1.5em;
    margin: 0px;
    padding: 0px;
}
 
 

    </style>
</head>
<body>
    <div class="container">
        <h1>आज का पर्चा</h1>
        <div class="date-input">
            <label for="outputDate">Date:</label>
            <input type="date" id="outputDate">
        </div>
        <table>
            <thead>
                <tr>
                    <th>पिछला बाकी</th>
                    <th>आमद</th>
                    <th>योग</th>
                    <th>बाकी माल</th>
                    <th> बिक्री</th>
                    <th> दर </th>
                    <th>किमत</th>
                    <!-- <th>Profit</th> -->
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" id="output1" readonly></td>
                    <td><input type="text" id="output2" readonly></td>
                    <td><input type="text" id="output3" readonly></td>
                    <td><input type="text" id="output4" readonly></td>
                    <td><input type="text" id="output5" readonly></td>
                    <td>70</td>
                    <td><input type="text" id="output6" readonly></td>
                </tr>
            </tbody>
        </table>
        <h2 style="text-align: center; color: #555; font-size: 20px;">खर्च का विवरड</h2>
        <table>
            <tr>
                <th>खर्च</th>
                <th> खर्च का विवरड</th>
                <th>दिया गया रुपया</th>
            </tr>
            <tr>
                <td>
                    <label for="expance"></label>
                    <input type="text" id="expance" readonly>

                </td>
                <td style="position: relative;">
                    <!-- <label for="description"> विवरड:</label> -->
                    <input type="text" id="description" placeholder="Speak here..." />
                    <img src="microphone.png" alt="Voice Input" class="voice-icon" id="voiceIcon">
                </td>
                <td>
                    <label for="payble amonut"></label>
                    <input type="text" id="payble" readonly>
                </td>
            </tr>
        </table>
        <h2 style="text-align: center; color: #555; font-size: 20px;">आप की बचत</h2>
        <table>
         
            <tr>
                <td>
                    <label for="output7" id="profitHeader">आपकी बचत :</label>
                    <input type="text" id="output7" readonly>
                </td>

                <td colspan="2">
                    <label for="output8">ऑनलाइन कितनी पैसे आई:</label>
                    <input type="text" id="output8" >
                </td>
           
            </tr>
        </table>
        <a href="#" id="downloadButton" class="btn">Download CSV</a>
        
    <button onclick="generateData()" id="genatedata" style="margin-right: 80%;">SAVE DATA</button>
    <!-- <button onclick="downloadCSV() ">Download CSV</button> -->
    <button id="navigateButton"  style="margin-left: 70%;"> show parch</button>
    </div>

    <script>
    document.getElementById("navigateButton").addEventListener("click", function() {
  // Redirect to newfile.html
    window.location.href = "newfile.html"; });

     // Retrieve inputs from local storage
     var a = localStorage.getItem('input1') || '0';
        var b = localStorage.getItem('input2') || '0';
        var c = localStorage.getItem('input3') || '0';
        var d = localStorage.getItem('input4') || '0';
        var e = localStorage.getItem('input5') || '0';
        var h = localStorage.getItem('input7') || '0';
        var i = localStorage.getItem('input8') || '0';

        // Calculate available mal
        var totalmal = (parseFloat(a) + parseFloat(b) * 45);
        var availableMal = (parseFloat(c) * 45) + parseFloat(d);
        var totalsale = parseFloat(totalmal) - parseFloat(availableMal);
        
        // Display inputs in the output page
        document.getElementById('output1').value = parseFloat(a);
        document.getElementById('output2').value = parseFloat(b) * 45;
        document.getElementById('output3').value = parseFloat(a) + parseFloat(b) * 45;
        document.getElementById('output4').value = parseFloat(a) + parseFloat(b) * 45 - parseFloat(e);
        document.getElementById('output5').value = parseFloat(e);
        document.getElementById('output6').value = parseFloat(e) * 75;
        document.getElementById('output7').value = parseFloat(h) - parseFloat(totalsale)*75 ;
       // document.getElementById('output8').value = parseFloat(h) - (parseFloat(e) * 75) -
        document.getElementById('expance').value = parseFloat(i);
        // document.getElementById('description').value = parseFloat(i);
        document.getElementById('payble').value =  parseFloat(e) * 75 - parseFloat(i);


        

        

        // Set the date input tag to the current date
        var today = new Date().toISOString().split('T')[0];
        document.getElementById('outputDate').value = today;

        // Function to convert the data to CSV format
        function convertToCSV(data) {
            var csv = '';
            for (var i = 0; i < data.length; i++) {
                csv += data[i].join(',') + '\n';
            }
            return csv;
        }

        // Function to trigger the CSV download
        function downloadCSV(csvContent, fileName) {
            var link = document.createElement('a');
            var blob = new Blob([csvContent], { type: 'text/csv' });
            link.href = window.URL.createObjectURL(blob);
            link.download = fileName;
            link.click();
        }

        // Event listener for download button click
        document.getElementById('downloadButton').addEventListener('click', function() {
            var today = new Date().toISOString().split('T')[0];
            var fileName = 'output_' + today + '.csv';

            var data = [
                ['Old Mal', 'Entry', 'Total', 'Remain', 'Bikri', 'DAR', 'Kimat', 'Payble Amount', 'Expense', 'Description', 'Profit', 'Online Money'],
                [a, b, parseFloat(a) + parseFloat(b), parseFloat(a) + parseFloat(b) - parseFloat(e), e, 75, parseFloat(e) * 75, parseFloat(e) * 75 - parseFloat(i), parseFloat(i), '', parseFloat(h) - (parseFloat(e) * 75), parseFloat(h) - (parseFloat(e) * 75) - parseFloat(i)]
            ];

            var csvContent = convertToCSV(data);
            downloadCSV(csvContent, fileName);
        });
        
        function generateData() {
            // Retrieve input values
            const date = document.getElementById('outputDate').value;
            const oldMal = document.getElementById('output1').value;
            const entry = document.getElementById('output2').value;
            const total = document.getElementById('output3').value;
            const remain = document.getElementById('output4').value;
            const bikri = document.getElementById('output5').value;
            const dar = '75'; // Fixed value
            const kimat = document.getElementById('output6').value;
            const paybleAmount = document.getElementById('payble').value;
            const expense = document.getElementById('expance').value;
            const description = document.getElementById('description').value;
            const profit = document.getElementById('output7').value;
            const onlineMoney = document.getElementById('output8').value;

            // Check if any field is empty
            if (!date || !oldMal || !entry || !total || !remain || !bikri || !kimat || !paybleAmount || !expense || !description || !profit || !onlineMoney) {
                alert('Please fill in all fields.');
                return;
            }

            // Create today's data object
            const todayData = {
                Date: date,
                'Old Mal': oldMal,
                आमद: entry,
                Total: total,
                Remain: remain,
                Bikri: bikri,
                DAR: dar,
                Kimat: kimat,
                'Payble Amount': paybleAmount,
                Expense: expense,
                Description: description,
                Profit: profit,
                'Online Money': onlineMoney
            };

            // Retrieve existing data from local storage or initialize an empty array
            let allData = JSON.parse(localStorage.getItem('inputData')) || [];

            // Append today's data to the array
            allData.push(todayData);

            // Store the updated data back to local storage
            localStorage.setItem('inputData', JSON.stringify(allData));

            // Clear input fields after storing data
            document.getElementById('outputDate').value = '';
            document.getElementById('output1').value = '';
            document.getElementById('output2').value = '';
            document.getElementById('output3').value = '';
            document.getElementById('output4').value = '';
            document.getElementById('output5').value = '';
            document.getElementById('output6').value = '';
            document.getElementById('output7').value = '';
            document.getElementById('output8').value = '';
        }

        function downloadCSV() {
            // Retrieve data from local storage
            const allData = JSON.parse(localStorage.getItem('inputData')) || [];

            // Check if there is any data to export
            if (allData.length === 0) {
                alert("No data available to export.");
                return;
            }

            // Convert data to CSV format
            const csvContent = 'Date,Old Mal,Entry,Total,Remain,Bikri,DAR,Kimat,Payble Amount,Expense,Description,Profit,Online Money\n' + allData.map(row =>
                `${row.Date},${row['Old Mal']},${row.Entry},${row.Total},${row.Remain},${row.Bikri},${row.DAR},${row.Kimat},${row['Payble Amount']},${row.Expense},${row.Description},${row.Profit},${row['Online Money']}`
            ).join('\n');

            // Create Blob object
            const blob = new Blob([csvContent], { type: 'text/csv' });

            // Create temporary link element
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'daily_data.csv';

            // Trigger click event on link
            link.click();
        }
    

        var profit = parseFloat(document.getElementById('output7').value);
        var profitHeader = document.getElementById('profitHeader');

        // Check profit value and add corresponding class to the header
        if (profit < 0) {
            profitHeader.classList.add('profit-negative');
        } else {
            profitHeader.classList.add('profit-positive');
        }

        // Highlight profit and profit + online money fields
        var profitField = document.getElementById('output7');
        var profitOnlineField = document.getElementById('output8');

        if (parseFloat(profitField.value) < 0) {
            profitField.classList.add('highlight');
        }

        if (parseFloat(profitOnlineField.value) < 0) {
            profitOnlineField.classList.add('highlight');
        }


// voie tyoing features
          // JavaScript to handle voice typing
          const descriptionInput = document.getElementById('description');
        const voiceIcon = document.getElementById('voiceIcon');

        // Check if browser supports speech recognition
        if ('speechRecognition' in window || 'webkitSpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();

            // Set recognition properties
          // Set recognition properties
                recognition.lang = 'en-US';
                recognition.continuous = false;

            // Event listener for voice icon click to start voice recognition
            voiceIcon.addEventListener('click', () => {
                recognition.start();
            });

            // Event listener for recognition result
            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                descriptionInput.value = transcript;
            };

            // Event listener for recognition error
            recognition.onerror = (event) => {
                console.error('Speech recognition error:', event.error);
            };
        } else {
            // Speech recognition not supported
            console.error('Speech recognition is not supported in this browser.');
            voiceIcon.style.display = 'none'; // Hide voice icon if not supported
        }
        
    </script>
</body>
</html>

